SELECT
    YEAR (TO_DATE (DIM_DATE, 'YYYYMMDD')) AS YEAR,
    CATEGORY,
    TXT_CONS_SUPPLIER_L1 AS SUPPLIER,
    TXT_BENCHMARKING_TYPE AS BENCHMARKING_ROLES,
    AVG(MES_ACTUAL_PRICE) AS ACTUAL_DELIVERABLE,
    AVG(MES_BENCHMARK_PRICE) AS BENCHMARK_DELIVERABLE,
    SUM(MES_HOURS) AS NUMBER_OF_HOURS,
    (AVG(MES_ACTUAL_PRICE) - AVG(MES_BENCHMARK_PRICE)) * SUM(MES_HOURS) AS DELIVERABLE_BENCHMARKING_OPPORTUNITY
FROM
    DATA.VT_C_FACT_DIGITAL_BENCHMARKS FMC
    JOIN DATA.VT_C_DIM_SUPPLIER SUP ON SUP.DIM_SUPPLIER = FMC.DIM_SUPPLIER
WHERE
    YEAR (TO_DATE (DIM_DATE, 'YYYYMMDD')) = YEAR (CURRENT_DATE)
    AND LOWER(CATEGORY) = LOWER('Marketing Svcs')
    AND LOWER(TXT_TYPE) = LOWER('Deliverable')
GROUP BY
    YEAR (TO_DATE (DIM_DATE, 'YYYYMMDD')),
    CATEGORY,
    TXT_CONS_SUPPLIER_L1,
    TXT_BENCHMARKING_TYPE