SELECT
    YEAR(TO_DATE(DIM_DATE, 'YYYYMMDD')) AS YEAR,
    CATEGORY,
    TXT_GRADE AS ROLE,
    AVG(MES_ACTUAL_PRICES) AS ACTUAL_BILL_RATE,
    AVG(MES_PRICE_BENCHMARK) AS BILL_RATE_BENCHMARK,
    SUM(MES_HOURS) AS HOURS,
    (ACTUAL_BILL_RATE-BILL_RATE_BENCHMARK)*HOURS AS BILL_RATE_BENCHMARK_OPPORTUNITY
FROM
    DATA.VT_C_FACT_ACTUAL_BILL_RATES
WHERE 
    YEAR(TO_DATE(DIM_DATE, 'YYYYMMDD')) = YEAR(CURRENT_DATE)
    AND LOWER(CATEGORY) = LOWER('Marketing Svcs')
GROUP BY
    YEAR(TO_DATE(DIM_DATE, 'YYYYMMDD')),
    CATEGORY,
    TXT_GRADE